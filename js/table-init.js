let table;function initTable(t){table=$("#unitTable").DataTable({data:t,pageLength:100,responsive:!0,order:[[3,"asc"]],columns:[{data:"unit_name",title:"Icon",render:t=>`<img src="data/icons/${t}.png" alt="${t}" data-testid="icon-${t}" style="width:40px;height:40px;" loading="lazy">`,orderable:!1},{data:"unit_name",title:"Unit Name"},{data:"rank",title:"Rank"},{data:"sp",title:"SP"},{data:"sp_reward",title:"SP on Kill"},{data:"promotion_reward",title:"Promotion Reward"},{data:null,title:"Owned",render:function(t,e,n){const a=getStoredValue(n.unit_name,"owned",n.rank)?"checked":"";return`<label><input type="checkbox" class="owned-checkbox" data-unit="${n.unit_name}" data-rank="${n.rank}" ${a}><span data-testid="checkbox-owned-${n.unit_name}-${n.rank}"></span></label>`},orderable:!1},{data:null,title:"Ranked",render:function(t,e,n){const a=getStoredValue(n.unit_name,"ranked",n.rank)?"checked":"";return`<label><input type="checkbox" class="ranked-checkbox"  data-unit="${n.unit_name}" data-rank="${n.rank}" ${a}><span data-testid="checkbox-ranked-${n.unit_name}-${n.rank}"></span></label>`},orderable:!1},{data:"unlock_level",title:"Unit Unlock Level"},{data:"pre_req_rank",title:"Pre-Rank requirement"},{data:"category",title:"Category"},{data:"unit_type",title:"Unit Type"},{data:"building_requirement",title:"Building Requirement"},{data:"other_requirements",title:"Other Requirements"},{data:"requires_nanopods",title:"Requires Nanopods",render:t=>t?"Yes":"No"}],drawCallback:function(){const t=getStoredTrackingData();$("#unitTable .owned-checkbox").each(function(){const e=`${$(this).data("unit")}::${$(this).data("rank")}`,n=t[e]?.owned||!1;$(this).prop("checked",n)}),$("#unitTable .ranked-checkbox").each(function(){const e=`${$(this).data("unit")}::${$(this).data("rank")}`,n=t[e]?.ranked||!1;$(this).prop("checked",n)}),$("#unitTable .owned-checkbox").off().on("change",function(){const t=$(this).data("unit");updateTracking(t,"owned",this.checked),highlight($(this).closest("tr")),document.getElementById("torank-count").textContent=`${countTotalRanksTodo()}`,document.getElementById("owned-count").textContent=`${countOwnedUnits()}`}),$("#unitTable .ranked-checkbox").off().on("change",function(){const t=$(this).data("unit"),e=$(this).data("rank");highlight($(this).closest("tr")),updateTracking(t,"ranked",this.checked,e),document.getElementById("ranked-count").textContent=`${countRankedUnits()}`,document.getElementById("torank-count").textContent=`${countTotalRanksTodo()}`})}})}